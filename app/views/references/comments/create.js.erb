<%
  comment_and_comments_container = render('comments/comment', comment: @comment) do
    render('form', comment: reference.comments.build)
    content_tag(:div, '', class: 'comments', 'data-commentable-id' => @comment.id)
  end
%>

commentsContainer = $("div.reference.comments[data-commentable-id=<%= reference.id %>]");
commentsContainer.prepend("<%= escape_javascript(comment_and_comments_container) %>");

commentsCountSpan = $("span#comments-count-<%= reference.id %>");
commentsCount = parseInt(commentsCountSpan.text());
commentsCountSpan.text(parseInt(commentsCount) + 1);
